<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Document
    </title>
    <link rel='stylesheet' href=../../../css/index.css />
    <link rel='stylesheet' href=../../../css/c.css /><link rel='stylesheet' href=../../../css/css.css /><link rel='stylesheet' href=../../../css/json.css /><link rel='stylesheet' href=../../../css/python.css /><link rel='stylesheet' href=../../../css/shell.css /><link rel='stylesheet' href=../../../css/toml.css /><link rel='stylesheet' href=../../../css/txt.css /><link rel='stylesheet' href=../../../css/yaml.css />
    <link rel="icon" href="https://raw.githubusercontent.com/learner-lu/picbed/master/logo.png">
</head>

<body class="light">
    <a href="https://github.com/luzhixing12345/luzhixing12345.github.io.git" target="_blank" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <div class="header-navigator"><ul><li><a href="#h2-0">服务器端口</a></li></ul><ul><li><a href="#h2-1">服务器域名</a></li></ul><ul><li><a href="#h2-2">HTTPS的申请与二级域名</a></li></ul><ul><li><a href="#h2-3">服务器端口反向代理</a></li></ul><ul><li><a href="#h2-4">创建用户</a></li></ul></div><div class='markdown-body'><hr><p>title: 服务器的各项配置 date: 2022-07-10 10:38:01 tags: 服务器</p><hr><blockquote><p>本文以华为的云服务器为例,各大服务器平台基本流程类似.本文默认已经购买了一台服务器,并且完成了基本的操作系统搭建,具体可以参考本系列之前的两篇文章</p></blockquote><h2 id="h2-0">服务器端口</h2><blockquote><p>如果你对服务器的基本端口/域名/端口号尚且不清楚,可以先阅读这篇科普文章,<a href="https://www.jianshu.com/p/806d0514ec7d" target="_blank">IP,域名和端口号之间的联系</a>,我觉得说的还是清晰的</p></blockquote><p>我们现在来运行一个服务吧,在/home/目录下新建一个project文件夹,新建 <code>server.js</code>文件并写入以下代码创建一个简单的nodejs的HTTP服务</p><pre class="language-js"><code>const http = require(&#x27;http&#x27;);

const server = http.createServer((req, res) =&gt; {
    console.log(&quot;receive one connect&quot;);
    res.end(&#x27;hello world&#x27;)
});

server.listen(9000, () =&gt; {
    console.log(&quot;start server&quot;)
});</code></pre><p>启动服务</p><pre class="language-shell"><code><span class="Token Program ID">node</span><span class="Token SPACE"> </span><span class="Token ID">server.js</span></code></pre><p>接着打开浏览器,输入 <code>IP:9000</code> 看一看吧</p><p>什么也没有? 这很正常,虽然服务在9000端口启动了,但是你访问不了,只有服务器本机可以访问. 那么外界如何访问这个服务呢,你需要手动开启这个服务</p><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/20220710122352.png"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20220710122352.png" alt="20220710122352"></a></p><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/ajshd9y2.png"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/ajshd9y2.png" alt="ajshd9y2"></a></p><p>需要添加入方向规则和出方向规则,<b>注意出入两条规则都需要添加,不然还是无法访问</b></p><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/20220710122638.png"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20220710122638.png" alt="20220710122638"></a></p><p>我们开放9000端口,然后再次访问 <code>IP:9000</code></p><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/20220710122916.png"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20220710122916.png" alt="20220710122916"></a></p><p>很好,一个简单的hello world界面,并且在终端里也输出了<code>receive one connect</code></p><p>但是你会发现终端被占用了,一旦你关闭了终端或者使用ctrl+c结束进程就再也无法访问了,我们总不可能持续的开启这个终端不关闭吧,我们还要做别的事情啊,我的电脑不可能像服务器一样一直不关机啊,所以我们需要把这个服务挂在后台</p><pre class="language-shell"><code><span class="Token Program ID">nohup</span><span class="Token SPACE"> </span><span class="Token ID">node</span><span class="Token SPACE"> </span><span class="Token ID">server.js</span><span class="Token SPACE"> </span><span class="Token AMPERSAND">&amp;</span></code></pre><blockquote><p>nohup 就是不挂起的命令, &amp;代表运行在后台,我们也可以选择输出文件的名字,默认是nohup.txt,<a href="https://www.runoob.com/linux/linux-comm-nohup.html" target="_blank">参考</a></p></blockquote><p>现在我们可以在终端继续别的事情了,这个服务也会一直启动着不结束.你什么时候想访问都可以</p><p>如果想要结束这个服务怎么办呢? 可以使用命令查看所有进程</p><pre class="language-shell"><code><span class="Token Program ID">ps</span><span class="Token SPACE"> </span><span class="Token OPTION">-ef</span></code></pre><p>浏览一下所有进程,哦找了,node server.js, pid号是7964(这个自己看一下,每次都不一样,别杀错了)</p><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/20220710123447.png"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20220710123447.png" alt="20220710123447"></a></p><blockquote><p>也可以使用<code>ps -ef | grep server.js</code> 更加精确的搜索</p></blockquote><pre class="language-shell"><code><span class="Token Program ID">kill</span><span class="Token SPACE"> </span><span class="Token NUMBER">7964</span></code></pre><p>这样这个进程就结束了,但是这种方法稍微有点笨. 毕竟还要手动找一下,我这里推荐两个可以帮助我们在后台使用服务的,pm2和forever,我个人推荐使用pm2,命令行的输出做的更加美观一些~</p><p>安装</p><pre class="language-shell"><code><span class="Token Program ID">npm</span><span class="Token SPACE"> </span><span class="Token ID">install</span><span class="Token SPACE"> </span><span class="Token OPTION">-g</span><span class="Token SPACE"> </span><span class="Token ID">pm2</span></code></pre><pre class="language-shell"><code><span class="Token Program ID">pm2</span><span class="Token SPACE"> </span><span class="Token ID">start</span><span class="Token SPACE"> </span><span class="Token ID">server.js</span><span class="Token SPACE">        </span><span class="Token PATH">//</span><span class="Token SPACE"> </span><span class="Token ID">启动</span><span class="Token LF">
</span><span class="Token Program ID">pm2</span><span class="Token SPACE"> </span><span class="Token ID">stop</span><span class="Token SPACE"> </span><span class="Token ID">server.js</span><span class="Token SPACE">         </span><span class="Token PATH">//</span><span class="Token SPACE"> </span><span class="Token ID">停止</span><span class="Token LF">
</span><span class="Token Program ID">pm2</span><span class="Token SPACE"> </span><span class="Token ID">restart</span><span class="Token SPACE"> </span><span class="Token ID">server.js</span><span class="Token SPACE">      </span><span class="Token PATH">//</span><span class="Token SPACE"> </span><span class="Token ID">重启</span></code></pre><p>查看所有运行后台服务</p><pre class="language-shell"><code><span class="Token Program ID">pm2</span><span class="Token SPACE"> </span><span class="Token ID">list</span><span class="Token LF">
</span><span class="Token Program ID">pm2</span><span class="Token SPACE"> </span><span class="Token ID">flush</span><span class="Token SPACE"> </span><span class="Token PATH">//</span><span class="Token SPACE"> </span><span class="Token ID">清除日志</span></code></pre><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/20220710124206.png"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20220710124206.png" alt="20220710124206"></a></p><p>也可以直接查看log日志</p><pre class="language-shell"><code><span class="Token Program ID">pm2</span><span class="Token SPACE"> </span><span class="Token ID">log</span><span class="Token SPACE">    </span><span class="Token PATH">//</span><span class="Token SPACE"> </span><span class="Token ID">查看所有运行后台服务</span><span class="Token LF">
</span><span class="Token Program ID">pm2</span><span class="Token SPACE"> </span><span class="Token ID">log</span><span class="Token SPACE"> </span><span class="Token NUMBER">0</span><span class="Token SPACE">  </span><span class="Token PATH">//</span><span class="Token SPACE"> </span><span class="Token ID">单独查看某一个的日志</span></code></pre><p>可以直接通过id关闭服务</p><pre class="language-shell"><code><span class="Token Program ID">pm2</span><span class="Token SPACE"> </span><span class="Token ID">stop</span><span class="Token SPACE"> </span><span class="Token NUMBER">0</span></code></pre><blockquote><p>forever的命令完全相同,把pm2换成forever就行了,使用起来差不多</p></blockquote><h2 id="h2-1">服务器域名</h2><p>现在我们可以启动一个服务了,但是似乎我们的访问方式有点老土,直接访问ip:端口号有点不专业,不好记也不方便.</p><p>正常都是直接访问一个网址的,这就需要域名的出场了.我们需要购买一个域名</p><blockquote><p>这里推荐一个<a href="https://www.bilibili.com/video/BV1ma4y1h79M" target="_blank">视频</a>,对域名的讲解很全面,顶级域/一级二级域名都说的不错,这个视频系列也是很通俗易懂的理解服务的相关知识,建议看一下</p></blockquote><p><a href="https://www.huaweicloud.com/product/domain.html" target="_blank">华为云-域名注册</a>,你可以在这里购买一个域名,可以选<code>xyz top</code>这样的顶级域,比较便宜</p><p>域名购买完成了之后不是直接就可以和服务器绑定使用的,在中国还需要进行<a href="https://beian.huaweicloud.com/" target="_blank">IPC备案</a>,各大云服务器厂商也都提供了备案方式,在哪里购买的域名就在哪里备案就可以,省得麻烦.</p><p>备案步骤比较繁琐,先有平台审核,然后管局审核,我的域名<code>kamilu.top</code>就是大约10多天才备案通过,不同地区的管局处理速度不同,一般都是十天左右</p><p>备案完成之后我们就可以进行域名的DNS解析了,华为云的<a href="https://support.huaweicloud.com/usermanual-cloudsite/cloudsite_01_4110.html" target="_blank">解析文档</a>说的很详细了,我就不再赘述</p><blockquote><p><a href="https://support.huaweicloud.com/dns_faq/dns_faq_1403.html" target="_blank">域名解析不生效文档</a></p></blockquote><p>将域名映射到服务器之后,你就可以通过域名来替换你的IP地址了,这样刚才的服务就可以通过 <code>域名:9000</code> 来访问了</p><p>如果网站访问不了,也可以通过<a href="https://support.huaweicloud.com/ecs_faq/zh-cn_topic_0167429326.html" target="_blank">网站无法访问怎么办</a>这篇文章来排查问题</p><blockquote><p>C:\Windows\System32\drivers\etc -&gt; HOST文件</p></blockquote><h2 id="h2-2">HTTPS的申请与二级域名</h2><p>我们现在的连接是HTTP连接,我们最好使用HTTPS的连接,有了SSL的服务更加安全.</p><p>可以在华为云 <a href="https://www.huaweicloud.com/product/scm.html" target="_blank">HTTPS证书申请</a>申请一个证书,很快也不复杂</p><p>个人用户没必要购买,可以直接使用免费的证书</p><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/20220708143135.png"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20220708143135.png" alt="20220708143135"></a></p><p>购买之后会指引如何进行DNS解析,在<a href="https://console.huaweicloud.com/console/?region=cn-north-4&locale=zh-cn#/ccm/scs/certList" target="_blank">SSL证书管理</a>可以看到进度</p><p>DNS解析就是加一个_dnsauth的域名,选择TXT,输入值,这个也都有文档很详细的说明</p><p>对于二级域名同理,域名选择你的二级域名就可以了</p><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/20220710135618.png"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20220710135618.png" alt="20220710135618"></a></p><p>不要忘记开启SSL服务哦,云服务器端口哪里的安全组可以快速添加,很方便</p><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/20220708145028.png"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20220708145028.png" alt="20220708145028"></a></p><h2 id="h2-3">服务器端口反向代理</h2><p>那么我们接下来把证书的部署和端口一起处理一下,平时似乎也没见过谁访问一个网址还要单独带一个端口号,最好我们直接就是输入一个网址就可以访问服务了,这里用到nginx的反向代理服务,可以把你的网址的访问映射到端口号的服务上</p><p>安装</p><pre class="language-shell"><code><span class="Token Program ID">sudo</span><span class="Token SPACE"> </span><span class="Token ID">apt</span><span class="Token SPACE"> </span><span class="Token ID">install</span><span class="Token SPACE"> </span><span class="Token ID">nginx</span></code></pre><p>后面的都需要root了, 启动Nginx服务</p><pre class="language-shell"><code><span class="Token Program ID">systemctl</span><span class="Token SPACE"> </span><span class="Token ID">start</span><span class="Token SPACE"> </span><span class="Token ID">nginx</span></code></pre><p>安装之后你可以查看你的nginx的配置文件的位置</p><pre class="language-shell"><code><span class="Token Program ID">nginx</span><span class="Token SPACE"> </span><span class="Token OPTION">-t</span></code></pre><p>显示配置文件在/etc/nginx/nginx.conf,打开这个文件,然后配置你的服务</p><blockquote><p>官网的nginx和我的不太一样,我看好多都是直接编译nginx的,我是一键下载,不过没啥大差别</p></blockquote><p>下载你的证书,然后你可以看到一个nginx的子文件夹,里面有两个文件(crt | key)</p><p>在/etc/nginx/ 下新建一个cert文件夹用于保存证书文件,然后将nginx的两个证书ftp传入这个目录</p><p>关于conf的配置文件主要如下,http请求转换成https请求, 对于443端口(HTTPS默认是443端口请求)映射到location的位置,默认index.html文件</p><p>我给出我的配置文件</p><p>这里解释一下我的配置,<code>kamilu.top</code>是我的一级域名也就是我购买的,访问这个域名会被跳转到<code>/home/cloud-server</code>这个目录下的<code>index.html</code>文件,也就是我的主页. ssl_certificate和ssl_certificate_key就是证书的名字,改成你的</p><p><b>注意这里不要放在一个用户下面</b>, css的显示会有问题</p><p>除此之外可以再申请一个HTTPS证书用于二级域名,二级域名不需要买,买了一级域名就可以使用旗下的所有二级域名,但是因为我们的HTTPS证书是免费的,所以所有的二级域名还是需要重新申请证书的,如果是泛域名的证书那么 <code>*.kamilu.top</code> 的二级域名都可以直接使用,不过那就要花钱了,也没必要</p><p><code>visual.kamilu.top</code> 是我的申请的一个二级域名,它会被映射到我的3000端口的服务,也就是说访问<code><a href="https://visual.kamilu.top" target="_blank">https://visual.kamilu.top</a></code>就相当于访问 <code><a href="https://kamilu.top:3000" target="_blank">https://kamilu.top:3000</a></code></p><blockquote><p>内容加在http {} 大括号中间的位置就可以</p></blockquote><pre class="language-txt"><code><span class="Token ID">events</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Token LF">
</span><span class="Token SPACE">  </span><span class="Token ID">worker_connections</span><span class="Token SPACE">  </span><span class="Token NUMBER">1024</span><span class="Token SEMI">;</span><span class="Token SPACE">  </span><span class="Token HASH">#</span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">Default</span><span class="Token COLON">:</span><span class="Token SPACE"> </span><span class="Token NUMBER">1024</span><span class="Token LF">
</span><span class="Token BraceDepth-0 RCURLY_BRACE">}</span><span class="Token LF">
</span><span class="Token ID">http</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LCURLY_BRACE">{</span><span class="Token LF">
</span><span class="Token SPACE">        </span><span class="Token ID">server</span><span class="Token SPACE"> </span><span class="Token BraceDepth-1 LCURLY_BRACE">{</span><span class="Token SPACE"> </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">自动跳转到https</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">listen</span><span class="Token SPACE"> </span><span class="Token NUMBER">80</span><span class="Token SEMI">;</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">server_name</span><span class="Token SPACE"> </span><span class="Token ID">kamilu</span><span class="Token DOT">.</span><span class="Token ID">top</span><span class="Token SEMI">;</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token HASH">#</span><span class="Token ID">将请求转成https</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">rewrite</span><span class="Token SPACE"> </span><span class="Token CARET">^</span><span class="Token BraceDepth-2 LPAREN">(</span><span class="Token DOT">.</span><span class="Token MUL">*</span><span class="Token BraceDepth-2 RPAREN">)</span><span class="Token DOLLAR">$</span><span class="Token SPACE"> </span><span class="Token ID">https</span><span class="Token COLON">:</span><span class="Token DIV">/</span><span class="Token DIV">/</span><span class="Token DOLLAR">$</span><span class="Token ID">host</span><span class="Token DOLLAR">$</span><span class="Token NUMBER">1</span><span class="Token SPACE"> </span><span class="Token ID">permanent</span><span class="Token SEMI">;</span><span class="Token LF">
</span><span class="Token SPACE">        </span><span class="Token BraceDepth-1 RCURLY_BRACE">}</span><span class="Token LF">
</span><span class="Token SPACE">        </span><span class="Token ID">server</span><span class="Token SPACE"> </span><span class="Token BraceDepth-1 LCURLY_BRACE">{</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">listen</span><span class="Token SPACE">       </span><span class="Token NUMBER">443</span><span class="Token SPACE"> </span><span class="Token ID">ssl</span><span class="Token SEMI">;</span><span class="Token SPACE"> </span><span class="Token HASH">#</span><span class="Token ID">配置HTTPS的默认访问端口为443</span><span class="Token TEXT">。</span><span class="Token ID">如果在此处未配置HTTPS的默认访问端口</span><span class="Token TEXT">，</span><span class="Token ID">可能会导致Nginx无法启动</span><span class="Token TEXT">。</span><span class="Token LF">
</span><span class="Token SPACE">                        </span><span class="Token ID">server_name</span><span class="Token SPACE">  </span><span class="Token ID">kamilu</span><span class="Token DOT">.</span><span class="Token ID">top</span><span class="Token SEMI">;</span><span class="Token SPACE"> </span><span class="Token HASH">#</span><span class="Token ID">修改为您证书绑定的域名</span><span class="Token TEXT">。</span><span class="Token LF">
</span><span class="Token SPACE">                        </span><span class="Token ID">ssl_certificate</span><span class="Token SPACE">      </span><span class="Token ID">cert</span><span class="Token DIV">/</span><span class="Token ID">scs1657261851237_kamilu</span><span class="Token DOT">.</span><span class="Token ID">top_server</span><span class="Token DOT">.</span><span class="Token ID">crt</span><span class="Token SEMI">;</span><span class="Token SPACE"> </span><span class="Token HASH">#</span><span class="Token ID">替换成您的证书文件的路径</span><span class="Token TEXT">。</span><span class="Token LF">
</span><span class="Token SPACE">                        </span><span class="Token ID">ssl_certificate_key</span><span class="Token SPACE">  </span><span class="Token ID">cert</span><span class="Token DIV">/</span><span class="Token ID">scs1657261851237_kamilu</span><span class="Token DOT">.</span><span class="Token ID">top_server</span><span class="Token DOT">.</span><span class="Token ID">key</span><span class="Token SEMI">;</span><span class="Token SPACE"> </span><span class="Token HASH">#</span><span class="Token ID">替换成您的私钥文件的路径</span><span class="Token TEXT">。</span><span class="Token LF">
</span><span class="Token SPACE">                        </span><span class="Token ID">ssl_session_cache</span><span class="Token SPACE">    </span><span class="Token ID">shared</span><span class="Token COLON">:</span><span class="Token ID">SSL</span><span class="Token COLON">:</span><span class="Token NUMBER">1</span><span class="Token ID">m</span><span class="Token SEMI">;</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">ssl_session_timeout</span><span class="Token SPACE">  </span><span class="Token NUMBER">5</span><span class="Token ID">m</span><span class="Token SEMI">;</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">ssl_ciphers</span><span class="Token SPACE">  </span><span class="Token ID">HIGH</span><span class="Token COLON">:</span><span class="Token BANG">!</span><span class="Token ID">aNULL</span><span class="Token COLON">:</span><span class="Token BANG">!</span><span class="Token ID">MD5</span><span class="Token SEMI">;</span><span class="Token SPACE"> </span><span class="Token HASH">#</span><span class="Token ID">加密套件</span><span class="Token TEXT">。</span><span class="Token LF">
</span><span class="Token SPACE">                        </span><span class="Token ID">ssl_prefer_server_ciphers</span><span class="Token SPACE">  </span><span class="Token ID">on</span><span class="Token SEMI">;</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">location</span><span class="Token SPACE"> </span><span class="Token DIV">/</span><span class="Token SPACE"> </span><span class="Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Token LF">
</span><span class="Token SPACE">                        </span><span class="Token ID">root</span><span class="Token SPACE">   </span><span class="Token DIV">/</span><span class="Token ID">home</span><span class="Token DIV">/</span><span class="Token ID">cloud</span><span class="Token MINUS">-</span><span class="Token ID">server</span><span class="Token SEMI">;</span><span class="Token SPACE"> </span><span class="Token HASH">#</span><span class="Token ID">站点目录</span><span class="Token TEXT">。</span><span class="Token LF">
</span><span class="Token SPACE">                                </span><span class="Token ID">index</span><span class="Token SPACE">  </span><span class="Token ID">index</span><span class="Token DOT">.</span><span class="Token ID">html</span><span class="Token SEMI">;</span><span class="Token SPACE"> </span><span class="Token HASH">#</span><span class="Token ID">添加属性</span><span class="Token TEXT">。</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Token LF">
</span><span class="Token SPACE">        </span><span class="Token BraceDepth-1 RCURLY_BRACE">}</span><span class="Token LF">
</span><span class="Token SPACE">        </span><span class="Token ID">server</span><span class="Token SPACE"> </span><span class="Token BraceDepth-1 LCURLY_BRACE">{</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">listen</span><span class="Token SPACE">       </span><span class="Token NUMBER">443</span><span class="Token SPACE"> </span><span class="Token ID">ssl</span><span class="Token SEMI">;</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">server_name</span><span class="Token SPACE">  </span><span class="Token ID">visual</span><span class="Token DOT">.</span><span class="Token ID">kamilu</span><span class="Token DOT">.</span><span class="Token ID">top</span><span class="Token SEMI">;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">ssl_certificate</span><span class="Token SPACE">      </span><span class="Token ID">cert</span><span class="Token DIV">/</span><span class="Token ID">scs1657282492078_visual</span><span class="Token DOT">.</span><span class="Token ID">kamilu</span><span class="Token DOT">.</span><span class="Token ID">top_server</span><span class="Token DOT">.</span><span class="Token ID">crt</span><span class="Token SEMI">;</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">ssl_certificate_key</span><span class="Token SPACE">  </span><span class="Token ID">cert</span><span class="Token DIV">/</span><span class="Token ID">scs1657282492078_visual</span><span class="Token DOT">.</span><span class="Token ID">kamilu</span><span class="Token DOT">.</span><span class="Token ID">top_server</span><span class="Token DOT">.</span><span class="Token ID">key</span><span class="Token SEMI">;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">ssl_session_cache</span><span class="Token SPACE">    </span><span class="Token ID">shared</span><span class="Token COLON">:</span><span class="Token ID">SSL</span><span class="Token COLON">:</span><span class="Token NUMBER">1</span><span class="Token ID">m</span><span class="Token SEMI">;</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">ssl_session_timeout</span><span class="Token SPACE">  </span><span class="Token NUMBER">5</span><span class="Token ID">m</span><span class="Token SEMI">;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">ssl_ciphers</span><span class="Token SPACE">  </span><span class="Token ID">HIGH</span><span class="Token COLON">:</span><span class="Token BANG">!</span><span class="Token ID">aNULL</span><span class="Token COLON">:</span><span class="Token BANG">!</span><span class="Token ID">MD5</span><span class="Token SEMI">;</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">ssl_prefer_server_ciphers</span><span class="Token SPACE">  </span><span class="Token ID">on</span><span class="Token SEMI">;</span><span class="Token LF">
</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">location</span><span class="Token SPACE"> </span><span class="Token DIV">/</span><span class="Token SPACE"> </span><span class="Token BraceDepth-2 LCURLY_BRACE">{</span><span class="Token LF">
</span><span class="Token SPACE">                        </span><span class="Token ID">proxy_pass</span><span class="Token SPACE"> </span><span class="Token ID">http</span><span class="Token COLON">:</span><span class="Token DIV">/</span><span class="Token DIV">/</span><span class="Token ID">localhost</span><span class="Token COLON">:</span><span class="Token NUMBER">3000</span><span class="Token DIV">/</span><span class="Token SEMI">;</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token BraceDepth-2 RCURLY_BRACE">}</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">modify</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">maximum</span><span class="Token SPACE"> </span><span class="Token ID">file</span><span class="Token SPACE"> </span><span class="Token ID">upload</span><span class="Token SPACE"> </span><span class="Token ID">size</span><span class="Token LF">
</span><span class="Token SPACE">                </span><span class="Token ID">client_max_body_size</span><span class="Token SPACE"> </span><span class="Token NUMBER">2000</span><span class="Token ID">m</span><span class="Token SEMI">;</span><span class="Token SPACE"> </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">如果有文件上传和下载功能需要注意修改为合适的值</span><span class="Token TEXT">，</span><span class="Token ID">默认为</span><span class="Token SPACE"> </span><span class="Token NUMBER">1</span><span class="Token ID">m</span><span class="Token LF">
</span><span class="Token SPACE">        </span><span class="Token BraceDepth-1 RCURLY_BRACE">}</span><span class="Token LF">
</span><span class="Token BraceDepth-0 RCURLY_BRACE">}</span></code></pre><p>修改完成之后你可以使用<code>nginx -t</code>查看一下有没有配置文件错误,如果ok,successful的话重启一下nginx服务</p><pre class="language-shell"><code><span class="Token Program ID">nginx:</span><span class="Token SPACE"> </span><span class="Token ID">the</span><span class="Token SPACE"> </span><span class="Token ID">configuration</span><span class="Token SPACE"> </span><span class="Token ID">file</span><span class="Token SPACE"> </span><span class="Token PATH">/etc/nginx/nginx.conf</span><span class="Token SPACE"> </span><span class="Token ID">syntax</span><span class="Token SPACE"> </span><span class="Token ID">is</span><span class="Token SPACE"> </span><span class="Token ID">ok</span><span class="Token LF">
</span><span class="Token Program ID">nginx:</span><span class="Token SPACE"> </span><span class="Token ID">configuration</span><span class="Token SPACE"> </span><span class="Token ID">file</span><span class="Token SPACE"> </span><span class="Token PATH">/etc/nginx/nginx.conf</span><span class="Token SPACE"> </span><span class="Token ID">test</span><span class="Token SPACE"> </span><span class="Token ID">is</span><span class="Token SPACE"> </span><span class="Token ID">successful</span></code></pre><pre class="language-shell"><code><span class="Token Program ID">systemctl</span><span class="Token SPACE"> </span><span class="Token ID">reload</span><span class="Token SPACE"> </span><span class="Token ID">nginx</span></code></pre><p>稍微等待一会儿,然后访问你的域名,不加任何端口号就可以看到主页了(如果你的这个目录下有东西的话),访问二级域名也可以看到了</p><blockquote><p>注意要使用https访问</p></blockquote><h2 id="h2-4">创建用户</h2><pre class="language-shell"><code><span class="Token Program ID">adduser</span><span class="Token SPACE"> </span><span class="Token ID">kamilu</span></code></pre><p>将kamilu添加到sudo组：</p><pre class="language-shell"><code><span class="Token Program ID">usermod</span><span class="Token SPACE"> </span><span class="Token OPTION">-aG</span><span class="Token SPACE"> </span><span class="Token ID">sudo</span><span class="Token SPACE"> </span><span class="Token ID">kamilu</span></code></pre><pre class="language-shell"><code><span class="Token Program ID">sudo</span><span class="Token SPACE"> </span><span class="Token ID">whoami</span></code></pre></div>
    <div class="dir-tree"><ul><li><a href="../../md-docs/README" >README</a></li></ul><ul><li><a href="../../环境配置/docker基本命令" >环境配置</a><ul><li><a href="../../环境配置/docker基本命令" >docker基本命令</a></li></ul><ul><li><a href="../../环境配置/gcc版本切换" >gcc版本切换</a></li></ul><ul><li><a href="../../环境配置/Linux代理配置" >Linux代理配置</a></li></ul><ul><li><a href="../../环境配置/mysql使用" >mysql使用</a></li></ul><ul><li><a href="../../环境配置/nodejs" >nodejs</a></li></ul><ul><li><a href="../../环境配置/pws" >pws</a></li></ul><ul><li><a href="../../环境配置/Ubuntu切换NVIDIA驱动" >Ubuntu切换NVIDIA驱动</a></li></ul><ul><li><a href="../../环境配置/Ubuntu工作环境配置" >Ubuntu工作环境配置</a></li></ul><ul><li><a href="../../环境配置/VMware虚拟机配置" >VMware虚拟机配置</a></li></ul><ul><li><a href="../../环境配置/WSL2配置" >WSL2配置</a></li></ul><ul><li><a href="../../环境配置/zsh配置" >zsh配置</a></li></ul><ul><li><a href="../../环境配置/双系统安装" >双系统安装</a></li></ul></li></ul><ul><li><a href="../../服务器/SSH" >服务器</a><ul><li><a href="../../服务器/SSH" >SSH</a></li></ul><ul><li><a href="../../服务器/服务器入门" >服务器入门</a></li></ul><ul><li><a href="../../服务器/服务器的各项配置" >服务器的各项配置</a></li></ul><ul><li><a href="../../服务器/网络通信" >网络通信</a></li></ul><ul><li><a href="../../服务器/内存占用高排查" >内存占用高排查</a></li></ul></li></ul><ul><li><a href="../../csapp/浮点数的表示" >csapp</a><ul><li><a href="../../csapp/浮点数的表示" >浮点数的表示</a></li></ul></li></ul><ul><li><a href="../../GAN/GAN网络详解(一)" >GAN</a><ul><li><a href="../../GAN/GAN网络详解(一)" >GAN网络详解(一)</a></li></ul><ul><li><a href="../../GAN/GAN网络详解(三)" >GAN网络详解(三)</a></li></ul><ul><li><a href="../../GAN/GAN网络详解(二)" >GAN网络详解(二)</a></li></ul><ul><li><a href="../../GAN/GAN网络详解(四)" >GAN网络详解(四)</a></li></ul></li></ul><ul><li><a href="../../git/gitignore使用" >git</a><ul><li><a href="../../git/gitignore使用" >gitignore使用</a></li></ul><ul><li><a href="../../git/git常用命令" >git常用命令</a></li></ul><ul><li><a href="../../git/git的branch和pull" >git的branch和pull</a></li></ul><ul><li><a href="../../git/git的commit用法" >git的commit用法</a></li></ul><ul><li><a href="../../git/git的SSH连接" >git的SSH连接</a></li></ul><ul><li><a href="../../git/git的使用" >git的使用</a></li></ul></li></ul><ul><li><a href="../../python/pytorch预训练模型下载地址" >python</a><ul><li><a href="../../python/pytorch预训练模型下载地址" >pytorch预训练模型下载地址</a></li></ul><ul><li><a href="../../python/优雅的日志记录-logging" >优雅的日志记录-logging</a></li></ul><ul><li><a href="../../python/使用PYPI发布python包" >使用PYPI发布python包</a></li></ul><ul><li><a href="../../python/测试覆盖率" >测试覆盖率</a></li></ul><ul><li><a href="../../python/深度学习模型部署-1" >深度学习模型部署-1</a></li></ul><ul><li><a href="../../python/深度学习模型部署-2" >深度学习模型部署-2</a></li></ul></li></ul><ul><li><a href="../../体系结构/cache" >体系结构</a><ul><li><a href="../../体系结构/cache" >cache</a></li></ul><ul><li><a href="../../体系结构/DRAM" >DRAM</a></li></ul><ul><li><a href="../../体系结构/NVM" >NVM</a></li></ul><ul><li><a href="../../体系结构/RDMA简介" >RDMA简介</a></li></ul><ul><li><a href="../../体系结构/动态内存分配" >动态内存分配</a></li></ul><ul><li><a href="../../体系结构/虚拟内存" >虚拟内存</a></li></ul></li></ul><ul><li><a href="../../杂/vscode基本配置" >杂</a><ul><li><a href="../../杂/vscode基本配置" >vscode基本配置</a></li></ul><ul><li><a href="../../杂/疑难杂症的报错" >疑难杂症的报错</a></li></ul></li></ul><ul><li><a href="../../网站/hexo部署网页" >网站</a><ul><li><a href="../../网站/hexo部署网页" >hexo部署网页</a></li></ul><ul><li><a href="../../网站/搭建个人博客" >搭建个人博客</a></li></ul><ul><li><a href="../../网站/注意事项" >注意事项</a></li></ul></li></ul><ul><li><a href="../../linux/cli" >linux</a><ul><li><a href="../../linux/cli" >cli</a></li></ul></li></ul></div>
    <div class="zood"><a class="" href="https://github.com/luzhixing12345/zood" target="_blank">zood</a></div>
    <script type="text/javascript" src="../../../js/next_front.js"></script><script>addLink("../../服务器/服务器入门","../../服务器/网络通信","ab");</script><script type="text/javascript" src="../../../js/change_mode.js"></script><script>addChangeModeButton("../../../img/sun.png","../../../img/moon.png");</script><script type="text/javascript" src="../../../js/copy_code.js"></script><script>addCodeCopy("../../../img/before_copy.png","../../../img/after_copy.png");</script><script type="text/javascript" src="../../../js/navigator.js"></script><script type="text/javascript" src="../../../js/picture_preview.js"></script><script type="text/javascript" src="../../../js/global_js_configuration.js"></script>
</body>

</html>